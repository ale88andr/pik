{% extends 'layout.html' %}

{% block content %}
    <section>
        <div class="container">
            <div class="row">
                <div class="col-lg-3 col-sm-12">
                    <div class="card shadow mb-3">
                        <div class="card-header py-3">
                            <h6 class="m-0 font-weight-bold text-primary">{{ customer.name }}</h6>
                        </div>
                        <div class="card-body">
                            <h4 class="card-title text-info">
                                {% if customer.phone %}
                                    {{ customer.phone }}
                                {% else %}
                                    <span class="text-body-tertiary">Не указан</span>
                                {% endif %}
                            </h4>
                            <p class="card-text">
                                {% if customer.telegram_id %}
                                    <a href="https://t.me/{{ customer.telegram_id }}" target="_blank">{{ customer.telegram_id }}</a>
                                {% else %}
                                    <span class="text-body-tertiary">Не указан</span>
                                {% endif %}
                            </p>
                            <p class="card-text">
                                Комиссия: <span class="badge bg-warning">{{ customer.tax }}%</span>
                            </p>
                            <a href="{% url 'customer_edit' pk=customer.pk %}" class="btn btn-sm btn-primary me-1">
                                <i class="bi bi-pencil-square"></i> Редактировать
                            </a>
                        </div>
                    </div>
                    <div class="card shadow mb-4">
                        <div class="card-header py-3">
                            <h6 class="m-0 font-weight-bold text-primary">{{ purchase.title }}</h6>
                        </div>
                        <div class="card-body">
                            <div class="d-flex justify-content-between align-items-center mb-2 text-body">
                                Заказов: <span class="ms-2 badge bg-dark">{{ total }}</span>
                            </div>
                        </div>
                    </div>
                    <div class="d-flex flex-column mt-4">
                        <a href="{% url 'create-customer-order' pk=customer.pk purchase_pk=purchase.pk %}" class="btn btn-success">
                            <i class="bi bi-person-plus"></i> Добавить заказ в закупку
                        </a>
                        <a href="{% url 'customer-purchase-xls2' pk=customer.pk purchase_pk=purchase.pk %}" class="btn btn-outline-secondary mt-2">
                            <i class="bi bi-filetype-xls"></i> Скачать заказ клиента
                        </a>
                    </div>
                </div>
                <div class="col-lg-9 col-sm-12">
                    {% for item in orders %}
                        <div class="row mb-3">
                            <div class="col-md-12 col-xl-12">
                                <div class="card shadow-0 border rounded-3">
                                <div class="card-body">
                                    <div class="row">
                                    <div class="col-md-3 col-lg-1 col-xl-1 mb-4 mb-lg-0">
                                        <div class="bg-image hover-zoom ripple rounded ripple-surface">
                                            <img
                                                src="/media/{{item.img}}"
                                                alt=""
                                                style="width: 64px"
                                                data-bs-toggle="offcanvas"
                                                href="#img-{{ item.id }}"
                                                role="button"
                                                aria-controls="show"
                                            />
                                            <div class="offcanvas offcanvas-start" tabindex="-1" id="img-{{ item.id }}" aria-labelledby="img-{{ item.id }}Label">
                                                <div class="offcanvas-header">
                                                    <h4 class="text-start text-info" id="img-{{ item.id }}Label">{{ item.title }}</h4>
                                                    <button type="button" class="btn-close text-reset" data-bs-dismiss="offcanvas" aria-label="Close"></button>
                                                </div>
                                                <div class="offcanvas-body">
                                                    <img
                                                        src="/media/{{item.img}}"
                                                        alt=""
                                                        style="width: 100%"
                                                    />
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-6 col-lg-8 col-xl-8">
                                        <h5>
                                            <a href="{% url 'order' pk=item.pk %}">
                                                {{ item.title }}
                                            </a>
                                        </h5>
                                        <div class="d-flex flex-row">
                                            <span class="badge bg-dark me-1">{{ item.marketplace }}</span>
                                            <span class="badge bg-info me-1">{{ item.get_status }}</span>
                                            <span class="badge bg-primary">
                                                {% if item.track_num %}
                                                    <a class="link-light" href="https://www.ordertracker.com/ru/track/{{ item.track_num }}" target="_blank">{{ item.track_num }}</a>
                                                {% else %}
                                                    Нет
                                                {%endif%}
                                            </span>
                                        </div>
                                        <div class="mt-1 mb-0 text-muted small">
                                        <span>100% cotton</span>
                                        <span class="text-primary"> • </span>
                                        <span>Light weight</span>
                                        <span class="text-primary"> • </span>
                                        <span>Best finish<br /></span>
                                        </div>
                                        <div class="mb-2 text-muted small">
                                        <span>Unique design</span>
                                        <span class="text-primary"> • </span>
                                        <span>For men</span>
                                        <span class="text-primary"> • </span>
                                        <span>Casual<br /></span>
                                        </div>
                                        <p class="text-truncate mb-4 mb-md-0">
                                        There are many variations of passages of Lorem Ipsum available, but the
                                        majority have suffered alteration in some form, by injected humour, or
                                        randomised words which don't look even slightly believable.
                                        </p>
                                    </div>
                                    <div class="col-md-4 col-lg-2 col-xl-2 border-sm-start-none border-start">
                                        <div class="d-flex flex-row align-items-center mb-1">
                                        <h4 class="mb-1 me-1">¥{{ item.order_price }}</h4>
                                        <span class="text-danger">₽{{ item.calculate_order_exchange_price }}</span>
                                        </div>
                                        <h6 class="text-success">

                                        </h6>
                                        <div class="d-flex flex-column mt-4">
                                            <button data-mdb-button-init data-mdb-ripple-init class="btn btn-primary btn-sm" type="button">Подробнее</button>
                                            <button data-mdb-button-init data-mdb-ripple-init class="btn btn-outline-primary btn-sm mt-2" type="button">
                                                Add to wishlist
                                            </button>
                                        </div>
                                    </div>
                                    </div>
                                </div>
                                </div>
                            </div>
                        </div>
                    {% endfor %}
                </div>
                
            </div>
        </div>
    </section>
{% endblock %}
